<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Dashboard - EmpowerFund</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <link rel="stylesheet" href="/css/dashboard.css">
  
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

</head>
<body>

  <aside class="sidebar-final">
    <div class="sidebar-header">
      <h2 class="sidebar-title">EmpowerFund</h2>
    </div>
    <nav class="sidebar-nav">
      <a href="/dashboard" class="active"><i class="fas fa-home"></i> Overview</a>
      <a href="/investments"><i class="fas fa-chart-line"></i> Investments</a>
      <a href="/stocks"><i class="fas fa-chart-bar"></i> Stock Market</a>
      <a href="/sip"><i class="fas fa-calculator"></i> SIP Calculator</a>
      <a href="/emi"><i class="fas fa-file-invoice-dollar"></i> EMI Calculator</a>
      <a href="#"><i class="fas fa-book-open"></i> Resources</a>
    </nav>
    <div class="sidebar-user-profile">
        <div class="user-info">
            <span class="user-name"><%= user.name %></span>
            <span class="user-email"><%= user.email %></span>
        </div>
      <a href="/api/users/logout" class="logout-link"><i class="fas fa-sign-out-alt"></i></a>
    </div>
  </aside>

  <main class="main-content-final">
    <div class="widgets-grid-final">
      <div class="widget-card-final">
        <h3>Quick Tools</h3>
        <div class="quick-tools-container">
          <a href="/sip" class="tool-card">
            <i class="fas fa-calculator tool-icon"></i>
            <span class="tool-title">SIP Calculator</span>
            <p class="tool-description">Plan your systematic investments.</p>
          </a>
          <a href="/emi" class="tool-card">
            <i class="fas fa-file-invoice-dollar tool-icon"></i>
            <span class="tool-title">EMI Calculator</span>
            <p class="tool-description">Calculate your loan installments.</p>
          </a>
        </div>
      </div>
      <div class="widget-card-final">
        <h3>Financial Snapshot</h3>
        <div class="chart-container" style="position: relative; height:100%; width:100%">
            <canvas id="investmentChart"></canvas>
        </div>
      </div>
      <div class="widget-card-final full-width-card">
        <h3>Investment Overview</h3>
        <ul class="investment-list-final">
          <li>
            <i class="fas fa-piggy-bank list-icon"></i>
            <div class="list-item-details">
              <strong>High-Yield Savings</strong>
              <span>A safe place for your short-term goals.</span>
            </div>
            <strong class="list-item-amount" data-value="5230.00">$5,230.00</strong>
          </li>
          <li>
            <i class="fas fa-seedling list-icon"></i>
            <div class="list-item-details">
              <strong>Eco-Friendly Mutual Fund</strong>
              <span>Investing in a sustainable future.</span>
            </div>
            <strong class="list-item-amount" data-value="12850.00">$12,850.00</strong>
          </li>
           <li>
            <i class="fas fa-building list-icon"></i>
            <div class="list-item-details">
              <strong>Real Estate Trust</strong>
              <span>Long-term growth through property.</span>
            </div>
            <strong class="list-item-amount" data-value="25400.00">$25,400.00</strong>
          </li>
        </ul>
      </div>
    </div>
  </main>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const investmentLabels = [];
      const investmentData = [];

      // Extract data from the "Investment Overview" list
      document.querySelectorAll('.investment-list-final .list-item-details strong').forEach(labelEl => {
        investmentLabels.push(labelEl.textContent);
      });
      document.querySelectorAll('.investment-list-final .list-item-amount').forEach(amountEl => {
        investmentData.push(parseFloat(amountEl.getAttribute('data-value')));
      });

      const ctx = document.getElementById('investmentChart').getContext('2d');
      new Chart(ctx, {
        type: 'pie',
        data: {
          labels: investmentLabels,
          datasets: [{
            label: 'Investment Value',
            data: investmentData,
            backgroundColor: [
              '#0b486b', // Deep Blue
              '#007991', // Teal
              '#3aafa9'  // Lighter Teal
            ],
            borderColor: '#fff',
            borderWidth: 2
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              position: 'bottom',
              labels: {
                font: {
                    family: "'Poppins', sans-serif"
                }
              }
            }
          }
        }
      });
    });
  </script>

</body>
</html>